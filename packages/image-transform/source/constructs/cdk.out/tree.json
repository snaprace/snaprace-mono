{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.202.0"},"children":{"ServerlessImageHandlerStack":{"id":"ServerlessImageHandlerStack","path":"ServerlessImageHandlerStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.202.0"},"children":{"CorsEnabledParameter":{"id":"CorsEnabledParameter","path":"ServerlessImageHandlerStack/CorsEnabledParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"CorsOriginParameter":{"id":"CorsOriginParameter","path":"ServerlessImageHandlerStack/CorsOriginParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"SourceBucketsParameter":{"id":"SourceBucketsParameter","path":"ServerlessImageHandlerStack/SourceBucketsParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"DeployDemoUIParameter":{"id":"DeployDemoUIParameter","path":"ServerlessImageHandlerStack/DeployDemoUIParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"LogRetentionPeriodParameter":{"id":"LogRetentionPeriodParameter","path":"ServerlessImageHandlerStack/LogRetentionPeriodParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"AutoWebPParameter":{"id":"AutoWebPParameter","path":"ServerlessImageHandlerStack/AutoWebPParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"EnableSignatureParameter":{"id":"EnableSignatureParameter","path":"ServerlessImageHandlerStack/EnableSignatureParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"SecretsManagerSecretParameter":{"id":"SecretsManagerSecretParameter","path":"ServerlessImageHandlerStack/SecretsManagerSecretParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"SecretsManagerKeyParameter":{"id":"SecretsManagerKeyParameter","path":"ServerlessImageHandlerStack/SecretsManagerKeyParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"EnableDefaultFallbackImageParameter":{"id":"EnableDefaultFallbackImageParameter","path":"ServerlessImageHandlerStack/EnableDefaultFallbackImageParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"FallbackImageS3BucketParameter":{"id":"FallbackImageS3BucketParameter","path":"ServerlessImageHandlerStack/FallbackImageS3BucketParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"FallbackImageS3KeyParameter":{"id":"FallbackImageS3KeyParameter","path":"ServerlessImageHandlerStack/FallbackImageS3KeyParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"CloudFrontPriceClassParameter":{"id":"CloudFrontPriceClassParameter","path":"ServerlessImageHandlerStack/CloudFrontPriceClassParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"OriginShieldRegionParameter":{"id":"OriginShieldRegionParameter","path":"ServerlessImageHandlerStack/OriginShieldRegionParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"EnableS3ObjectLambdaParameter":{"id":"EnableS3ObjectLambdaParameter","path":"ServerlessImageHandlerStack/EnableS3ObjectLambdaParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"UseExistingCloudFrontDistributionParameter":{"id":"UseExistingCloudFrontDistributionParameter","path":"ServerlessImageHandlerStack/UseExistingCloudFrontDistributionParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"ExistingCloudFrontDistributionIdParameter":{"id":"ExistingCloudFrontDistributionIdParameter","path":"ServerlessImageHandlerStack/ExistingCloudFrontDistributionIdParameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"ExistingDistributionIdRequiredRule":{"id":"ExistingDistributionIdRequiredRule","path":"ServerlessImageHandlerStack/ExistingDistributionIdRequiredRule","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.202.0"}},"Solution":{"id":"Solution","path":"ServerlessImageHandlerStack/Solution","constructInfo":{"fqn":"aws-cdk-lib.CfnMapping","version":"2.202.0"}},"SendAnonymousStatistics":{"id":"SendAnonymousStatistics","path":"ServerlessImageHandlerStack/SendAnonymousStatistics","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"DeployCloudWatchDashboard":{"id":"DeployCloudWatchDashboard","path":"ServerlessImageHandlerStack/DeployCloudWatchDashboard","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"CommonResources":{"id":"CommonResources","path":"ServerlessImageHandlerStack/CommonResources","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"DeployDemoUICondition":{"id":"DeployDemoUICondition","path":"ServerlessImageHandlerStack/CommonResources/DeployDemoUICondition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"EnableSignatureCondition":{"id":"EnableSignatureCondition","path":"ServerlessImageHandlerStack/CommonResources/EnableSignatureCondition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"EnableDefaultFallbackImageCondition":{"id":"EnableDefaultFallbackImageCondition","path":"ServerlessImageHandlerStack/CommonResources/EnableDefaultFallbackImageCondition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"EnableCorsCondition":{"id":"EnableCorsCondition","path":"ServerlessImageHandlerStack/CommonResources/EnableCorsCondition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"AutoWebPCondition":{"id":"AutoWebPCondition","path":"ServerlessImageHandlerStack/CommonResources/AutoWebPCondition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"EnableOriginShieldCondition":{"id":"EnableOriginShieldCondition","path":"ServerlessImageHandlerStack/CommonResources/EnableOriginShieldCondition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"EnableS3ObjectLambdaCondition":{"id":"EnableS3ObjectLambdaCondition","path":"ServerlessImageHandlerStack/CommonResources/EnableS3ObjectLambdaCondition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"DisableS3ObjectLambdaCondition":{"id":"DisableS3ObjectLambdaCondition","path":"ServerlessImageHandlerStack/CommonResources/DisableS3ObjectLambdaCondition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"IsLogRetentionPeriodInfinite":{"id":"IsLogRetentionPeriodInfinite","path":"ServerlessImageHandlerStack/CommonResources/IsLogRetentionPeriodInfinite","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"UseExistingCloudFrontDistributionCondition":{"id":"UseExistingCloudFrontDistributionCondition","path":"ServerlessImageHandlerStack/CommonResources/UseExistingCloudFrontDistributionCondition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"SecretsManagerPolicy":{"id":"SecretsManagerPolicy","path":"ServerlessImageHandlerStack/CommonResources/SecretsManagerPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/CommonResources/SecretsManagerPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"secretsmanager:GetSecretValue","Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":secretsmanager:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":secret:",{"Ref":"SecretsManagerSecretParameter"},"*"]]}}],"Version":"2012-10-17"},"policyName":"CommonResourcesSecretsManagerPolicy45FE005E","roles":[{"Ref":"CommonResourcesCustomResourcesCustomResourceRole8958A1ED"},{"Ref":"BackEndImageHandlerFunctionRoleABF81E5C"}]}}}}},"CustomResources":{"id":"CustomResources","path":"ServerlessImageHandlerStack/CommonResources/CustomResources","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"CustomResourceRole":{"id":"CustomResourceRole","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.202.0","metadata":[]},"children":{"ImportCustomResourceRole":{"id":"ImportCustomResourceRole","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceRole/ImportCustomResourceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.202.0","metadata":[]}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"path":"/","policies":[{"policyName":"CloudWatchLogsPolicy","policyDocument":{"Statement":[{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":log-group:/aws/lambda/*"]]}}],"Version":"2012-10-17"}},{"policyName":"S3AccessPolicy","policyDocument":{"Statement":[{"Action":["s3:ListBucket","s3:GetBucketLocation"],"Effect":"Allow","Resource":{"Fn::Split":[",",{"Fn::Sub":["arn:aws:s3:::${rest}",{"rest":{"Fn::Join":[",arn:aws:s3:::",{"Fn::Split":[",",{"Fn::Join":["",{"Fn::Split":[" ",{"Ref":"SourceBucketsParameter"}]}]}]}]}}]}]}},{"Action":"s3:GetObject","Effect":"Allow","Resource":{"Fn::Join":["",["arn:aws:s3:::",{"Ref":"FallbackImageS3BucketParameter"},"/",{"Ref":"FallbackImageS3KeyParameter"}]]}},{"Action":["s3:putBucketAcl","s3:putEncryptionConfiguration","s3:putBucketPolicy","s3:CreateBucket","s3:PutBucketOwnershipControls","s3:PutBucketTagging","s3:PutBucketVersioning"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::*"]]}},{"Action":"s3:ListBucket","Effect":"Allow","Resource":"arn:aws:s3:::sih-dummy-*"}],"Version":"2012-10-17"}},{"policyName":"EC2Policy","policyDocument":{"Statement":[{"Action":"ec2:DescribeRegions","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"}},{"policyName":"ExistingDistributionPolicy","policyDocument":{"Statement":[{"Action":"cloudfront:GetDistribution","Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":cloudfront::",{"Ref":"AWS::AccountId"},":distribution/",{"Ref":"ExistingCloudFrontDistributionIdParameter"}]]}}],"Version":"2012-10-17"}}],"tags":[{"key":"SolutionId","value":"SO0023"}]}}}}},"CustomResourceFunction":{"id":"CustomResourceFunction","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.202.0","metadata":[]},"children":{"Code":{"id":"Code","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.202.0"},"children":{"Stage":{"id":"Stage","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.202.0"}},"AssetBucket":{"id":"AssetBucket","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.202.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"0841bc3fed4c53056a322d3680fec2d1427c7249825be26106ce7d41f73f333a.zip"},"description":"dynamic-image-transformation-for-amazon-cloudfront (custom-v7.0.5): Custom resource","environment":{"variables":{"SOLUTION_ID":"SO0023","RETRY_SECONDS":"5","SOLUTION_VERSION":"custom-v7.0.5"}},"handler":"index.handler","memorySize":128,"role":{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceRole8958A1ED","Arn"]},"runtime":"nodejs20.x","tags":[{"key":"SolutionId","value":"SO0023"}],"timeout":60}}}}},"CustomResourceUuid":{"id":"CustomResourceUuid","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceUuid","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceUuid/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}},"LogBucketCustomResource":{"id":"LogBucketCustomResource","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/LogBucketCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/LogBucketCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}},"CloudFrontLoggingBucket":{"id":"CloudFrontLoggingBucket","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CloudFrontLoggingBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.202.0","metadata":[]}},"CustomResourceCheckSourceBuckets":{"id":"CustomResourceCheckSourceBuckets","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceCheckSourceBuckets","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceCheckSourceBuckets/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}},"CustomResourceCheckFirstBucketRegion":{"id":"CustomResourceCheckFirstBucketRegion","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceCheckFirstBucketRegion","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceCheckFirstBucketRegion/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}},"CustomResourceCheckFallbackImage":{"id":"CustomResourceCheckFallbackImage","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceCheckFallbackImage","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceCheckFallbackImage/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}},"WebsiteHostingBucketPolicy":{"id":"WebsiteHostingBucketPolicy","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/WebsiteHostingBucketPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/WebsiteHostingBucketPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject","s3:PutObject"],"Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["FrontEndDistributionToS3S3Bucket3A171D78","Arn"]},"/*"]]}}],"Version":"2012-10-17"},"policyName":"CommonResourcesCustomResourcesWebsiteHostingBucketPolicy3C526944","roles":[{"Ref":"CommonResourcesCustomResourcesCustomResourceRole8958A1ED"}]}}}}},"CustomResourceAnonymousMetric":{"id":"CustomResourceAnonymousMetric","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceAnonymousMetric","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceAnonymousMetric/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}},"CustomResourceCheckSecretsManager":{"id":"CustomResourceCheckSecretsManager","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceCheckSecretsManager","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceCheckSecretsManager/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}},"CustomResourceValidateExistingDistribution":{"id":"CustomResourceValidateExistingDistribution","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceValidateExistingDistribution","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/CustomResourceValidateExistingDistribution/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}},"DeployWebsite":{"id":"DeployWebsite","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_deployment.BucketDeployment","version":"2.202.0"},"children":{"AwsCliLayer":{"id":"AwsCliLayer","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/AwsCliLayer","constructInfo":{"fqn":"aws-cdk-lib.lambda_layer_awscli.AwsCliLayer","version":"2.202.0","metadata":[]},"children":{"Code":{"id":"Code","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/AwsCliLayer/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.202.0"},"children":{"Stage":{"id":"Stage","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/AwsCliLayer/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.202.0"}},"AssetBucket":{"id":"AssetBucket","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/AwsCliLayer/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.202.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/AwsCliLayer/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnLayerVersion","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::LayerVersion","aws:cdk:cloudformation:props":{"content":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"1b2c92f2cd21c170884393633bd4c732676df6290562199b6e3ca5e2a1be7d18.zip"},"description":"/opt/awscli/aws"}}}}},"CustomResourceHandler":{"id":"CustomResourceHandler","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/CustomResourceHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.SingletonFunction","version":"2.202.0","metadata":[]}},"Asset1":{"id":"Asset1","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/Asset1","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.202.0"},"children":{"Stage":{"id":"Stage","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/Asset1/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.202.0"}},"AssetBucket":{"id":"AssetBucket","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/Asset1/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.202.0","metadata":[]}}}},"CustomResource":{"id":"CustomResource","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/CustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/DeployWebsite/CustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}}}},"PutWebsiteConfig":{"id":"PutWebsiteConfig","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/PutWebsiteConfig","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CommonResources/CustomResources/PutWebsiteConfig/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}}}}}},"FrontEnd":{"id":"FrontEnd","path":"ServerlessImageHandlerStack/FrontEnd","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"DistributionToS3":{"id":"DistributionToS3","path":"ServerlessImageHandlerStack/FrontEnd/DistributionToS3","constructInfo":{"fqn":"@aws-solutions-constructs/aws-cloudfront-s3.CloudFrontToS3","version":"2.51.0"},"children":{"S3Bucket":{"id":"S3Bucket","path":"ServerlessImageHandlerStack/FrontEnd/DistributionToS3/S3Bucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/FrontEnd/DistributionToS3/S3Bucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"lifecycleConfiguration":{"rules":[{"noncurrentVersionTransitions":[{"storageClass":"GLACIER","transitionInDays":90}],"status":"Enabled"}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:cr-owned:46d90a1b","value":"true"},{"key":"SolutionId","value":"SO0023"}],"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"ServerlessImageHandlerStack/FrontEnd/DistributionToS3/S3Bucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/FrontEnd/DistributionToS3/S3Bucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"FrontEndDistributionToS3S3Bucket3A171D78"},"policyDocument":{"Statement":[{"Action":"s3:*","Condition":{"Bool":{"aws:SecureTransport":"false"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":[{"Fn::GetAtt":["FrontEndDistributionToS3S3Bucket3A171D78","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FrontEndDistributionToS3S3Bucket3A171D78","Arn"]},"/*"]]}]},{"Action":"s3:GetObject","Condition":{"StringEquals":{"AWS:SourceArn":{"Fn::Join":["",["arn:aws:cloudfront::",{"Ref":"AWS::AccountId"},":distribution/",{"Ref":"FrontEndDistributionToS3CloudFrontDistribution15FE13D0"}]]}}},"Effect":"Allow","Principal":{"Service":"cloudfront.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["FrontEndDistributionToS3S3Bucket3A171D78","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"CloudFrontOac":{"id":"CloudFrontOac","path":"ServerlessImageHandlerStack/FrontEnd/DistributionToS3/CloudFrontOac","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnOriginAccessControl","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::OriginAccessControl","aws:cdk:cloudformation:props":{"originAccessControlConfig":{"name":{"Fn::Join":["",["aws-cloudfront-s3-DistnToS3-",{"Fn::Select":[2,{"Fn::Split":["/",{"Ref":"AWS::StackId"}]}]}]]},"originAccessControlOriginType":"s3","signingBehavior":"always","signingProtocol":"sigv4","description":"Origin access control provisioned by aws-cloudfront-s3"}}}},"CloudFrontDistribution":{"id":"CloudFrontDistribution","path":"ServerlessImageHandlerStack/FrontEnd/DistributionToS3/CloudFrontDistribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.202.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"ServerlessImageHandlerStack/FrontEnd/DistributionToS3/CloudFrontDistribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/FrontEnd/DistributionToS3/CloudFrontDistribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::GetAtt":["FrontEndDistributionToS3S3Bucket3A171D78","RegionalDomainName"]},"id":"ServerlessImageHandlerStackFrontEndDistributionToS3CloudFrontDistributionOrigin140765BF6","s3OriginConfig":{"originAccessIdentity":""}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"ServerlessImageHandlerStackFrontEndDistributionToS3CloudFrontDistributionOrigin140765BF6","cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6","compress":true,"viewerProtocolPolicy":"redirect-to-https"},"comment":"Demo UI Distribution for Dynamic Image Transformation for Amazon CloudFront","customErrorResponses":[{"errorCode":403,"responseCode":200,"responsePagePath":"/index.html"},{"errorCode":404,"responseCode":200,"responsePagePath":"/index.html"}],"defaultRootObject":"index.html","httpVersion":"http2","ipv6Enabled":true,"logging":{"bucket":{"Fn::Join":["",[{"Fn::GetAtt":["CommonResourcesCustomResourcesLogBucketCustomResource2445A3AB","BucketName"]},".s3.",{"Fn::GetAtt":["CommonResourcesCustomResourcesLogBucketCustomResource2445A3AB","Region"]},".",{"Ref":"AWS::URLSuffix"}]]},"prefix":"ui-cloudfront/"}},"tags":[{"key":"SolutionId","value":"SO0023"}]}}}}}}}}},"BackEnd":{"id":"BackEnd","path":"ServerlessImageHandlerStack/BackEnd","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"ImageHandlerFunctionRole":{"id":"ImageHandlerFunctionRole","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerFunctionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.202.0","metadata":[]},"children":{"ImportImageHandlerFunctionRole":{"id":"ImportImageHandlerFunctionRole","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerFunctionRole/ImportImageHandlerFunctionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.202.0","metadata":[]}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerFunctionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"path":"/","tags":[{"key":"SolutionId","value":"SO0023"}]}}}}},"ImageHandlerFunctionPolicy":{"id":"ImageHandlerFunctionPolicy","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerFunctionPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerFunctionPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":log-group:/aws/lambda/*"]]}},{"Action":"s3:GetObject","Effect":"Allow","Resource":{"Fn::Split":[",",{"Fn::Sub":["arn:aws:s3:::${rest}/*",{"rest":{"Fn::Join":["/*,arn:aws:s3:::",{"Fn::Split":[",",{"Fn::Join":["",{"Fn::Split":[" ",{"Ref":"SourceBucketsParameter"}]}]}]}]}}]}]}},{"Action":"s3:ListBucket","Effect":"Allow","Resource":{"Fn::Split":[",",{"Fn::Sub":["arn:aws:s3:::${rest}",{"rest":{"Fn::Join":[",arn:aws:s3:::",{"Fn::Split":[",",{"Fn::Join":["",{"Fn::Split":[" ",{"Ref":"SourceBucketsParameter"}]}]}]}]}}]}]}},{"Action":"s3:GetObject","Effect":"Allow","Resource":{"Fn::Join":["",["arn:aws:s3:::",{"Ref":"FallbackImageS3BucketParameter"},"/",{"Ref":"FallbackImageS3KeyParameter"}]]}},{"Action":["rekognition:DetectFaces","rekognition:DetectModerationLabels"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"BackEndImageHandlerFunctionPolicy437940B5","roles":[{"Ref":"BackEndImageHandlerFunctionRoleABF81E5C"}]}}}}},"ImageHandlerLambdaFunction":{"id":"ImageHandlerLambdaFunction","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerLambdaFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.202.0","metadata":[]},"children":{"Code":{"id":"Code","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerLambdaFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.202.0"},"children":{"Stage":{"id":"Stage","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerLambdaFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.202.0"}},"AssetBucket":{"id":"AssetBucket","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerLambdaFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.202.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerLambdaFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"8555d856689e42dde5db33049ec692932eb4b14deb7d5ded62102757b78f7bdb.zip"},"description":"dynamic-image-transformation-for-amazon-cloudfront (custom-v7.0.5): Performs image edits and manipulations","environment":{"variables":{"AUTO_WEBP":{"Ref":"AutoWebPParameter"},"CORS_ENABLED":{"Ref":"CorsEnabledParameter"},"CORS_ORIGIN":{"Ref":"CorsOriginParameter"},"SOURCE_BUCKETS":{"Ref":"SourceBucketsParameter"},"REWRITE_MATCH_PATTERN":"","REWRITE_SUBSTITUTION":"","ENABLE_SIGNATURE":{"Ref":"EnableSignatureParameter"},"SECRETS_MANAGER":{"Ref":"SecretsManagerSecretParameter"},"SECRET_KEY":{"Ref":"SecretsManagerKeyParameter"},"ENABLE_DEFAULT_FALLBACK_IMAGE":{"Ref":"EnableDefaultFallbackImageParameter"},"DEFAULT_FALLBACK_IMAGE_BUCKET":{"Ref":"FallbackImageS3BucketParameter"},"DEFAULT_FALLBACK_IMAGE_KEY":{"Ref":"FallbackImageS3KeyParameter"},"ENABLE_S3_OBJECT_LAMBDA":{"Ref":"EnableS3ObjectLambdaParameter"},"SOLUTION_VERSION":"custom-v7.0.5","SOLUTION_ID":"SO0023","SHARP_SIZE_LIMIT":{"Fn::FindInMap":["Solution","Config","SharpSizeLimit"]}}},"handler":"index.handler","memorySize":1024,"role":{"Fn::GetAtt":["BackEndImageHandlerFunctionRoleABF81E5C","Arn"]},"runtime":"nodejs20.x","tags":[{"key":"SolutionId","value":"SO0023"}],"timeout":29}}},"InvokeOmXtXvfmnVyX0ul6SNprKOdkal6YvZiIw5QCpG--sJFo=":{"id":"InvokeOmXtXvfmnVyX0ul6SNprKOdkal6YvZiIw5QCpG--sJFo=","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerLambdaFunction/InvokeOmXtXvfmnVyX0ul6SNprKOdkal6YvZiIw5QCpG--sJFo=","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackEndImageHandlerLambdaFunctionADEF7FF2","Arn"]},"principal":"cloudfront.amazonaws.com"}}}}},"ImageHandlerLogGroup":{"id":"ImageHandlerLogGroup","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerLogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerLogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"BackEndImageHandlerLambdaFunctionADEF7FF2"}]]},"retentionInDays":731,"tags":[{"key":"SolutionId","value":"SO0023"}]}}}}},"CachePolicy":{"id":"CachePolicy","path":"ServerlessImageHandlerStack/BackEnd/CachePolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CachePolicy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/CachePolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnCachePolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::CachePolicy","aws:cdk:cloudformation:props":{"cachePolicyConfig":{"name":{"Fn::Join":["",["ServerlessImageHandler-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]}]]},"minTtl":1,"maxTtl":31536000,"defaultTtl":86400,"parametersInCacheKeyAndForwardedToOrigin":{"cookiesConfig":{"cookieBehavior":"none"},"headersConfig":{"headerBehavior":"whitelist","headers":["origin","accept"]},"enableAcceptEncodingGzip":false,"enableAcceptEncodingBrotli":false,"queryStringsConfig":{"queryStringBehavior":"all"}}}}}}}},"OriginRequestPolicy":{"id":"OriginRequestPolicy","path":"ServerlessImageHandlerStack/BackEnd/OriginRequestPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.OriginRequestPolicy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/OriginRequestPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnOriginRequestPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::OriginRequestPolicy","aws:cdk:cloudformation:props":{"originRequestPolicyConfig":{"name":{"Fn::Join":["",["ServerlessImageHandler-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]}]]},"cookiesConfig":{"cookieBehavior":"none"},"headersConfig":{"headerBehavior":"whitelist","headers":["origin","accept"]},"queryStringsConfig":{"queryStringBehavior":"all"}}}}}}},"ExistingDistribution":{"id":"ExistingDistribution","path":"ServerlessImageHandlerStack/BackEnd/ExistingDistribution","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.202.0","metadata":[]}},"ApiGatewayRestApi":{"id":"ApiGatewayRestApi","path":"ServerlessImageHandlerStack/BackEnd/ApiGatewayRestApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApiBase","version":"2.202.0","metadata":[]}},"ApigRequestModifierFunction":{"id":"ApigRequestModifierFunction","path":"ServerlessImageHandlerStack/BackEnd/ApigRequestModifierFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Function","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ApigRequestModifierFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnFunction","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Function","aws:cdk:cloudformation:props":{"autoPublish":true,"functionCode":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\n\nfunction handler(event) {\n    // Normalize accept header to only include values used on the backend\n    if(event.request.headers && event.request.headers.accept && event.request.headers.accept.value) {\n        event.request.headers.accept.value = event.request.headers.accept.value.indexOf(\"image/webp\") > -1 ? \"image/webp\" : \"\"\n    }\n    event.request.querystring = processQueryParams(event.request.querystring).join('&')\n    return event.request;\n}\n\nfunction processQueryParams(querystring) {\n    if (querystring == null) {\n        return [];\n    }\n\n    const ALLOWED_PARAMS = ['signature', 'expires', 'format', 'fit', 'width', 'height', 'rotate', 'flip', 'flop', 'grayscale'];\n    \n    let qs = [];\n    for (const key in querystring) {\n        if (!ALLOWED_PARAMS.includes(key)) {\n            continue;\n        }\n        const value = querystring[key];\n        qs.push(\n            value.multiValue\n                ? `${key}=${value.multiValue[value.multiValue.length - 1].value}`\n                : `${key}=${value.value}`\n        )\n    }\n\n    return qs.sort();\n}","functionConfig":{"comment":{"Fn::Join":["",["sih-apig-request-modifier-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]}]]},"runtime":"cloudfront-js-2.0"},"name":{"Fn::Join":["",["sih-apig-request-modifier-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]}]]}}}}}},"ImageHandlerCloudFrontApiGatewayLambda":{"id":"ImageHandlerCloudFrontApiGatewayLambda","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda","constructInfo":{"fqn":"@aws-solutions-constructs/aws-cloudfront-apigateway-lambda.CloudFrontToApiGatewayToLambda","version":"2.51.0"},"children":{"ApiAccessLogGroup":{"id":"ApiAccessLogGroup","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/ApiAccessLogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/ApiAccessLogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"tags":[{"key":"SolutionId","value":"SO0023"}]}}}}},"LambdaRestApi":{"id":"LambdaRestApi","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.LambdaRestApi","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"binaryMediaTypes":["*/*"],"endpointConfiguration":{"types":["REGIONAL"]},"name":"LambdaRestApi","tags":[{"key":"SolutionId","value":"SO0023"}]}}},"Deployment":{"id":"Deployment","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"Automatically created by the RestApi construct","restApiId":{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"}}}}}},"DeploymentStage.image":{"id":"DeploymentStage.image","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/DeploymentStage.image","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/DeploymentStage.image/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"accessLogSetting":{"destinationArn":{"Fn::GetAtt":["BackEndImageHandlerCloudFrontApiGatewayLambdaApiAccessLogGroup9B786692","Arn"]},"format":"{\"requestId\":\"$context.requestId\",\"ip\":\"$context.identity.sourceIp\",\"user\":\"$context.identity.user\",\"caller\":\"$context.identity.caller\",\"requestTime\":\"$context.requestTime\",\"httpMethod\":\"$context.httpMethod\",\"resourcePath\":\"$context.resourcePath\",\"status\":\"$context.status\",\"protocol\":\"$context.protocol\",\"responseLength\":\"$context.responseLength\"}"},"deploymentId":{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiDeployment663240D697c3cdfc601da74f263d2bb8dcbb4a90"},"methodSettings":[{"httpMethod":"*","resourcePath":"/*","dataTraceEnabled":false,"loggingLevel":"INFO"}],"restApiId":{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"},"stageName":"image","tags":[{"key":"SolutionId","value":"SO0023"}],"tracingEnabled":true}}}}},"Default":{"id":"Default","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.202.0","metadata":[]},"children":{"{proxy+}":{"id":"{proxy+}","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default/{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ProxyResource","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default/{proxy+}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109","RootResourceId"]},"pathPart":"{proxy+}","restApiId":{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"}}}},"ANY":{"id":"ANY","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default/{proxy+}/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.202.0","metadata":[]},"children":{"ApiPermission.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..{proxy+}":{"id":"ApiPermission.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..{proxy+}","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default/{proxy+}/ANY/ApiPermission.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackEndImageHandlerLambdaFunctionADEF7FF2","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":",{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"},"/",{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiDeploymentStageimageB55D20E3"},"/*/*"]]}}}},"ApiPermission.Test.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..{proxy+}":{"id":"ApiPermission.Test.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..{proxy+}","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default/{proxy+}/ANY/ApiPermission.Test.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackEndImageHandlerLambdaFunctionADEF7FF2","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":",{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"},"/test-invoke-stage/*/*"]]}}}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default/{proxy+}/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:",{"Ref":"AWS::Region"},":lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["BackEndImageHandlerLambdaFunctionADEF7FF2","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiproxyBDF0A131"},"restApiId":{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"}}}}}}}},"ANY":{"id":"ANY","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.202.0","metadata":[]},"children":{"ApiPermission.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..":{"id":"ApiPermission.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default/ANY/ApiPermission.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackEndImageHandlerLambdaFunctionADEF7FF2","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":",{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"},"/",{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiDeploymentStageimageB55D20E3"},"/*/"]]}}}},"ApiPermission.Test.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..":{"id":"ApiPermission.Test.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default/ANY/ApiPermission.Test.ServerlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiF7C63563.ANY..","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackEndImageHandlerLambdaFunctionADEF7FF2","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":",{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"},"/test-invoke-stage/*/"]]}}}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/Default/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:",{"Ref":"AWS::Region"},":lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["BackEndImageHandlerLambdaFunctionADEF7FF2","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Fn::GetAtt":["BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109","RootResourceId"]},"restApiId":{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"}}}}}}}},"UsagePlan":{"id":"UsagePlan","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/UsagePlan","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.UsagePlan","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApi/UsagePlan/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnUsagePlan","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::UsagePlan","aws:cdk:cloudformation:props":{"apiStages":[{"apiId":{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"},"stage":{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiDeploymentStageimageB55D20E3"},"throttle":{}}],"tags":[{"key":"SolutionId","value":"SO0023"}]}}}}}}},"LambdaRestApiCloudWatchRole":{"id":"LambdaRestApiCloudWatchRole","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApiCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.202.0","metadata":[]},"children":{"ImportLambdaRestApiCloudWatchRole":{"id":"ImportLambdaRestApiCloudWatchRole","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApiCloudWatchRole/ImportLambdaRestApiCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.202.0","metadata":[]}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApiCloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"policies":[{"policyName":"LambdaRestApiCloudWatchRolePolicy","policyDocument":{"Statement":[{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:DescribeLogGroups","logs:DescribeLogStreams","logs:PutLogEvents","logs:GetLogEvents","logs:FilterLogEvents"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":*"]]}}],"Version":"2012-10-17"}}],"tags":[{"key":"SolutionId","value":"SO0023"}]}}}}},"LambdaRestApiAccount":{"id":"LambdaRestApiAccount","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/LambdaRestApiAccount","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApiCloudWatchRole12575C4D","Arn"]}}}},"CloudFrontToApiGateway":{"id":"CloudFrontToApiGateway","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/CloudFrontToApiGateway","constructInfo":{"fqn":"@aws-solutions-constructs/aws-cloudfront-apigateway.CloudFrontToApiGateway","version":"2.51.0"},"children":{"CloudFrontDistribution":{"id":"CloudFrontDistribution","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/CloudFrontToApiGateway/CloudFrontDistribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.202.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/CloudFrontToApiGateway/CloudFrontDistribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontApiGatewayLambda/CloudFrontToApiGateway/CloudFrontDistribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::Join":["",[{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaLambdaRestApi5A77D109"},".execute-api.",{"Ref":"AWS::Region"},".amazonaws.com"]]},"id":"verlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaCloudFrontToApiGatewayCloudFrontDistributionOrigin1BEFA9FF3","originPath":"/image","customOriginConfig":{"originSslProtocols":["TLSv1.1","TLSv1.2"],"originProtocolPolicy":"https-only"}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"verlessImageHandlerStackBackEndImageHandlerCloudFrontApiGatewayLambdaCloudFrontToApiGatewayCloudFrontDistributionOrigin1BEFA9FF3","allowedMethods":["GET","HEAD"],"cachePolicyId":{"Ref":"BackEndCachePolicy1DCE9B1B"},"compress":true,"originRequestPolicyId":{"Ref":"BackEndOriginRequestPolicy771345D7"},"viewerProtocolPolicy":"redirect-to-https","functionAssociations":[{"functionArn":{"Fn::GetAtt":["BackEndApigRequestModifierFunction400C4F08","FunctionARN"]},"eventType":"viewer-request"}]},"comment":"Image Handler Distribution for Dynamic Image Transformation for Amazon CloudFront","customErrorResponses":[{"errorCachingMinTtl":600,"errorCode":500},{"errorCachingMinTtl":600,"errorCode":501},{"errorCachingMinTtl":600,"errorCode":502},{"errorCachingMinTtl":600,"errorCode":503},{"errorCachingMinTtl":600,"errorCode":504}],"httpVersion":"http2","ipv6Enabled":true,"logging":{"bucket":{"Fn::Join":["",[{"Fn::GetAtt":["CommonResourcesCustomResourcesLogBucketCustomResource2445A3AB","BucketName"]},".s3.",{"Fn::GetAtt":["CommonResourcesCustomResourcesLogBucketCustomResource2445A3AB","Region"]},".",{"Ref":"AWS::URLSuffix"}]]},"prefix":"api-cloudfront/"},"priceClass":{"Ref":"CloudFrontPriceClassParameter"}},"tags":[{"key":"SolutionId","value":"SO0023"}]}}}}}}}}},"DeployAPIGDistribution":{"id":"DeployAPIGDistribution","path":"ServerlessImageHandlerStack/BackEnd/DeployAPIGDistribution","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"AccessPoint":{"id":"AccessPoint","path":"ServerlessImageHandlerStack/BackEnd/AccessPoint","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnAccessPoint","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::AccessPoint","aws:cdk:cloudformation:props":{"bucket":{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceCheckFirstBucketRegionE663CC31","BucketName"]},"name":{"Fn::Join":["",["sih-ap-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]},"-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceCheckFirstBucketRegionE663CC31","BucketHash"]}]]},"policy":{"Statement":{"Action":"s3:*","Condition":{"ForAnyValue:StringEquals":{"aws:CalledVia":"s3-object-lambda.amazonaws.com"}},"Effect":"Allow","Principal":{"Service":"cloudfront.amazonaws.com"},"Resource":[{"Fn::Join":["",["arn:aws:s3:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":accesspoint/sih-ap-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]},"-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceCheckFirstBucketRegionE663CC31","BucketHash"]}]]},{"Fn::Join":["",["arn:aws:s3:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":accesspoint/sih-ap-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]},"-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceCheckFirstBucketRegionE663CC31","BucketHash"]},"/object/*"]]}]}}}}},"OlResponseModifierFunction":{"id":"OlResponseModifierFunction","path":"ServerlessImageHandlerStack/BackEnd/OlResponseModifierFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Function","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/OlResponseModifierFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnFunction","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Function","aws:cdk:cloudformation:props":{"autoPublish":true,"functionCode":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\n\nfunction handler(event) {\n    const response = event.response;\n\n    try {\n        Object.keys(response.headers).forEach(key => {\n            if (key.startsWith(\"x-amz-meta-\") && key !== \"x-amz-meta-statuscode\") {\n                const headerName = key.replace(\"x-amz-meta-\", \"\");\n                response.headers[headerName] = response.headers[key];\n                delete response.headers[key];\n            }\n        });\n\n        const statusCodeHeader = response.headers[\"x-amz-meta-statuscode\"];\n        if (statusCodeHeader) {\n            const status = parseInt(statusCodeHeader.value);\n            if (status >= 400 && status <= 599) {\n                response.statusCode = status;\n            }\n\n            delete response.headers[\"x-amz-meta-statuscode\"];\n        }\n    } catch (e) {\n        console.log(\"Error: \", e);\n    }\n    return response;\n}\n","functionConfig":{"comment":{"Fn::Join":["",["sih-ol-response-modifier-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]}]]},"runtime":"cloudfront-js-2.0"},"name":{"Fn::Join":["",["sih-ol-response-modifier-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]}]]}}}}}},"OlRequestModifierFunction":{"id":"OlRequestModifierFunction","path":"ServerlessImageHandlerStack/BackEnd/OlRequestModifierFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Function","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/OlRequestModifierFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnFunction","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Function","aws:cdk:cloudformation:props":{"autoPublish":true,"functionCode":"// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nfunction handler(event) {\n    // Normalize accept header to only include values used on the backend\n    if(event.request.headers && event.request.headers.accept && event.request.headers.accept.value) {\n        event.request.headers.accept.value = event.request.headers.accept.value.indexOf(\"image/webp\") > -1 ? \"image/webp\" : \"\"\n    }\n    event.request.querystring = processQueryParams(event.request.querystring).join('&')\n    return event.request;\n}\n\nfunction processQueryParams(querystring) {\n    if (querystring == null) {\n        return [];\n    }\n\n    const ALLOWED_PARAMS = ['signature', 'expires', 'format', 'fit', 'width', 'height', 'rotate', 'flip', 'flop', 'grayscale'];\n    const OL_PARAMS = {'signature': 'ol-signature', 'expires': 'ol-expires'};\n    \n    let qs = [];\n    for (const key in querystring) {\n        if (!ALLOWED_PARAMS.includes(key)) {\n            continue;\n        }\n        const value = querystring[key];\n        const mappedKey = OL_PARAMS[key] || key;\n        qs.push(\n            value.multiValue\n                ? `${mappedKey}=${value.multiValue[value.multiValue.length - 1].value}`\n                : `${mappedKey}=${value.value}`\n        )\n    }\n\n    return qs.sort();\n}","functionConfig":{"comment":{"Fn::Join":["",["sih-ol-request-modifier-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]}]]},"runtime":"cloudfront-js-2.0"},"name":{"Fn::Join":["",["sih-ol-request-modifier-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]}]]}}}}}},"ObjectLambdaAccessPoint":{"id":"ObjectLambdaAccessPoint","path":"ServerlessImageHandlerStack/BackEnd/ObjectLambdaAccessPoint","constructInfo":{"fqn":"aws-cdk-lib.aws_s3objectlambda.CfnAccessPoint","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3ObjectLambda::AccessPoint","aws:cdk:cloudformation:props":{"name":{"Fn::Join":["",["sih-olap-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]}]]},"objectLambdaConfiguration":{"supportingAccessPoint":{"Fn::GetAtt":["BackEndAccessPoint6DA9B104","Arn"]},"transformationConfigurations":[{"actions":["GetObject","HeadObject"],"contentTransformation":{"AwsLambda":{"FunctionArn":{"Fn::GetAtt":["BackEndImageHandlerLambdaFunctionADEF7FF2","Arn"]}}}}]}}}},"WriteGetObjectResponsePolicy":{"id":"WriteGetObjectResponsePolicy","path":"ServerlessImageHandlerStack/BackEnd/WriteGetObjectResponsePolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/WriteGetObjectResponsePolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"s3-object-lambda:WriteGetObjectResponse","Effect":"Allow","Resource":{"Fn::GetAtt":["BackEndObjectLambdaAccessPointBEE6B960","Arn"]}}],"Version":"2012-10-17"},"policyName":"BackEndWriteGetObjectResponsePolicyF3008955","roles":[{"Ref":"BackEndImageHandlerFunctionRoleABF81E5C"}]}}}}},"ImageHandlerCloudFrontDistribution":{"id":"ImageHandlerCloudFrontDistribution","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontDistribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.202.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontDistribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/ImageHandlerCloudFrontDistribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::Join":["",[{"Fn::GetAtt":["BackEndObjectLambdaAccessPointBEE6B960","Alias.Value"]},".s3.",{"Ref":"AWS::Region"},".amazonaws.com"]]},"id":"ServerlessImageHandlerStackBackEndImageHandlerCloudFrontDistributionOrigin1F41D4CAD","originPath":"/image","connectionAttempts":1,"s3OriginConfig":{},"originShield":{"enabled":true,"originShieldRegion":{"Ref":"AWS::Region"}}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"ServerlessImageHandlerStackBackEndImageHandlerCloudFrontDistributionOrigin1F41D4CAD","allowedMethods":["GET","HEAD"],"cachePolicyId":{"Ref":"BackEndCachePolicy1DCE9B1B"},"compress":true,"originRequestPolicyId":{"Ref":"BackEndOriginRequestPolicy771345D7"},"viewerProtocolPolicy":"redirect-to-https","functionAssociations":[{"functionArn":{"Fn::GetAtt":["BackEndOlResponseModifierFunctionB47B3834","FunctionARN"]},"eventType":"viewer-response"},{"functionArn":{"Fn::GetAtt":["BackEndOlRequestModifierFunction7E5192E3","FunctionARN"]},"eventType":"viewer-request"}]},"comment":"Image Handler Distribution for Dynamic Image Transformation for Amazon CloudFront","customErrorResponses":[{"errorCachingMinTtl":600,"errorCode":500},{"errorCachingMinTtl":600,"errorCode":501},{"errorCachingMinTtl":600,"errorCode":502},{"errorCachingMinTtl":600,"errorCode":503},{"errorCachingMinTtl":600,"errorCode":504}],"httpVersion":"http2","ipv6Enabled":true,"logging":{"bucket":{"Fn::Join":["",[{"Fn::GetAtt":["CommonResourcesCustomResourcesLogBucketCustomResource2445A3AB","BucketName"]},".s3.",{"Fn::GetAtt":["CommonResourcesCustomResourcesLogBucketCustomResource2445A3AB","Region"]},".",{"Ref":"AWS::URLSuffix"}]]},"prefix":"api-cloudfront/"},"priceClass":{"Ref":"CloudFrontPriceClassParameter"}},"tags":[{"key":"SolutionId","value":"SO0023"}]}}}}},"DeployS3OLDistribution":{"id":"DeployS3OLDistribution","path":"ServerlessImageHandlerStack/BackEnd/DeployS3OLDistribution","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"ObjectLambdaAccessPointPolicy":{"id":"ObjectLambdaAccessPointPolicy","path":"ServerlessImageHandlerStack/BackEnd/ObjectLambdaAccessPointPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3objectlambda.CfnAccessPointPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3ObjectLambda::AccessPointPolicy","aws:cdk:cloudformation:props":{"objectLambdaAccessPoint":{"Ref":"BackEndObjectLambdaAccessPointBEE6B960"},"policyDocument":{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Principal":{"Service":"cloudfront.amazonaws.com"},"Action":"s3-object-lambda:Get*","Resource":{"Fn::GetAtt":["BackEndObjectLambdaAccessPointBEE6B960","Arn"]},"Condition":{"StringEquals":{"aws:SourceArn":{"Fn::Join":["",["arn:aws:cloudfront::",{"Ref":"AWS::AccountId"},":distribution/",{"Fn::If":["CommonResourcesUseExistingCloudFrontDistributionConditionEBC48184",{"Ref":"ExistingCloudFrontDistributionIdParameter"},{"Ref":"BackEndImageHandlerCloudFrontDistributionB5464C90"}]}]]}}}}]}}}},"SIH-origin-access-control":{"id":"SIH-origin-access-control","path":"ServerlessImageHandlerStack/BackEnd/SIH-origin-access-control","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnOriginAccessControl","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::OriginAccessControl","aws:cdk:cloudformation:props":{"originAccessControlConfig":{"name":{"Fn::Join":["",["SIH-origin-access-control-",{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]}]]},"originAccessControlOriginType":"s3","signingBehavior":"always","signingProtocol":"sigv4"}}}},"ShortLogRetentionCondition":{"id":"ShortLogRetentionCondition","path":"ServerlessImageHandlerStack/BackEnd/ShortLogRetentionCondition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}},"SolutionMetrics":{"id":"SolutionMetrics","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"MetricsLambda":{"id":"MetricsLambda","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda_nodejs.NodejsFunction","version":"2.202.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.202.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.202.0","metadata":[]}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"tags":[{"key":"SolutionId","value":"SO0023"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["sqs:SendMessage","sqs:GetQueueAttributes","sqs:GetQueueUrl"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue60A92083","Arn"]}},{"Action":["sqs:ReceiveMessage","sqs:ChangeMessageVisibility","sqs:GetQueueUrl","sqs:DeleteMessage","sqs:GetQueueAttributes"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue60A92083","Arn"]}},{"Action":"cloudwatch:GetMetricData","Effect":"Allow","Resource":"*"},{"Action":["logs:StartQuery","logs:GetQueryResults"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BackEndImageHandlerLogGroupA0941EEC","Arn"]}},{"Action":"logs:DescribeQueryDefinitions","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"BackEndSolutionMetricsMetricsLambdaServiceRoleDefaultPolicyEBDDA47A","roles":[{"Ref":"BackEndSolutionMetricsMetricsLambdaServiceRoleF4BC77CD"}]}}}}}}},"Code":{"id":"Code","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.202.0"},"children":{"Stage":{"id":"Stage","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.202.0"}},"AssetBucket":{"id":"AssetBucket","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.202.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"181f9dab1aba08559606595cdd0d17d4f7b827288970bf46d0d8a3302cec82d1.zip"},"description":"Metrics util","environment":{"variables":{"QUERY_PREFIX":{"Fn::Join":["",[{"Ref":"AWS::StackName"},"-"]]},"SOLUTION_ID":"SO0023","SOLUTION_NAME":"dynamic-image-transformation-for-amazon-cloudfront","SOLUTION_VERSION":"custom-v7.0.5","UUID":{"Fn::GetAtt":["CommonResourcesCustomResourcesCustomResourceUuid64E7CCAD","UUID"]},"EXECUTION_DAY":{"Fn::If":["BackEndShortLogRetentionCondition72EA1A33","*","MON"]},"SQS_QUEUE_URL":{"Ref":"BackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue60A92083"}}},"handler":"index.handler","memorySize":128,"role":{"Fn::GetAtt":["BackEndSolutionMetricsMetricsLambdaServiceRoleF4BC77CD","Arn"]},"runtime":"nodejs22.x","tags":[{"key":"SolutionId","value":"SO0023"}],"timeout":60}}},"AwsEventsLambdaInvokePermission-1":{"id":"AwsEventsLambdaInvokePermission-1","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/AwsEventsLambdaInvokePermission-1","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackEndSolutionMetricsMetricsLambdaF4FA4AF7","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["BackEndSolutionMetricsEventbridgeRuleToLambdaEventsRule05009025","Arn"]}}}},"SqsEventSource:ServerlessImageHandlerStackBackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue55784E12":{"id":"SqsEventSource:ServerlessImageHandlerStackBackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue55784E12","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/SqsEventSource:ServerlessImageHandlerStackBackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue55784E12","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/MetricsLambda/SqsEventSource:ServerlessImageHandlerStackBackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue55784E12/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"tags":[{"key":"SolutionId","value":"SO0023"}],"eventSourceArn":{"Fn::GetAtt":["BackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue60A92083","Arn"]},"functionName":{"Ref":"BackEndSolutionMetricsMetricsLambdaF4FA4AF7"}}}}}}}},"EventbridgeRuleToLambda":{"id":"EventbridgeRuleToLambda","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/EventbridgeRuleToLambda","constructInfo":{"fqn":"@aws-solutions-constructs/aws-eventbridge-lambda.EventbridgeToLambda","version":"2.85.6"},"children":{"EventsRule":{"id":"EventsRule","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/EventbridgeRuleToLambda/EventsRule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/EventbridgeRuleToLambda/EventsRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"scheduleExpression":{"Fn::Join":["",["cron(0 23 ? * ",{"Fn::If":["BackEndShortLogRetentionCondition72EA1A33","*","MON"]}," *)"]]},"state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["BackEndSolutionMetricsMetricsLambdaF4FA4AF7","Arn"]}}]}}}}}}},"LambdaToSqsToLambda":{"id":"LambdaToSqsToLambda","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/LambdaToSqsToLambda","constructInfo":{"fqn":"@aws-solutions-constructs/aws-lambda-sqs-lambda.LambdaToSqsToLambda","version":"2.85.6"},"children":{"lambda-to-sqs":{"id":"lambda-to-sqs","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/LambdaToSqsToLambda/lambda-to-sqs","constructInfo":{"fqn":"@aws-solutions-constructs/aws-lambda-sqs.LambdaToSqs","version":"2.85.6"},"children":{"queue":{"id":"queue","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/LambdaToSqsToLambda/lambda-to-sqs/queue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/LambdaToSqsToLambda/lambda-to-sqs/queue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"delaySeconds":900,"kmsMasterKeyId":"alias/aws/sqs","maximumMessageSize":1024,"messageRetentionPeriod":86400,"receiveMessageWaitTimeSeconds":20,"tags":[{"key":"SolutionId","value":"SO0023"}],"visibilityTimeout":1020}}},"Policy":{"id":"Policy","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/LambdaToSqsToLambda/lambda-to-sqs/queue/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.QueuePolicy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/LambdaToSqsToLambda/lambda-to-sqs/queue/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueuePolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::QueuePolicy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["sqs:DeleteMessage","sqs:ReceiveMessage","sqs:SendMessage","sqs:GetQueueAttributes","sqs:RemovePermission","sqs:AddPermission","sqs:SetQueueAttributes"],"Effect":"Allow","Principal":{"AWS":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::",{"Ref":"AWS::AccountId"},":root"]]}},"Resource":{"Fn::GetAtt":["BackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue60A92083","Arn"]},"Sid":"QueueOwnerOnlyAccess"},{"Action":"SQS:*","Condition":{"Bool":{"aws:SecureTransport":"false"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":{"Fn::GetAtt":["BackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue60A92083","Arn"]},"Sid":"HttpsOnly"}],"Version":"2012-10-17"},"queues":[{"Ref":"BackEndSolutionMetricsLambdaToSqsToLambdalambdatosqsqueue60A92083"}]}}}}}}}}},"sqs-to-lambda":{"id":"sqs-to-lambda","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/LambdaToSqsToLambda/sqs-to-lambda","constructInfo":{"fqn":"@aws-solutions-constructs/aws-sqs-lambda.SqsToLambda","version":"2.85.6"}}}},"BilledDurationMemorySizeQuery":{"id":"BilledDurationMemorySizeQuery","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/BilledDurationMemorySizeQuery","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.QueryDefinition","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/BilledDurationMemorySizeQuery/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnQueryDefinition","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::QueryDefinition","aws:cdk:cloudformation:props":{"logGroupNames":[{"Ref":"BackEndImageHandlerLogGroupA0941EEC"}],"name":{"Fn::Join":["",[{"Ref":"AWS::StackName"},"-BilledDurationMemorySizeQuery"]]},"queryString":"stats sum(@billedDuration) as AWSLambdaBilledDuration, max(@memorySize) as AWSLambdaMemorySize"}}}}},"RequestInfoQuery":{"id":"RequestInfoQuery","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/RequestInfoQuery","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.QueryDefinition","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/BackEnd/SolutionMetrics/RequestInfoQuery/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnQueryDefinition","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::QueryDefinition","aws:cdk:cloudformation:props":{"logGroupNames":[{"Ref":"BackEndImageHandlerLogGroupA0941EEC"}],"name":{"Fn::Join":["",[{"Ref":"AWS::StackName"},"-RequestInfoQuery"]]},"queryString":"parse @message \"requestType: 'Default'\" as DefaultRequests\n| parse @message \"requestType: 'Thumbor'\" as ThumborRequests\n| parse @message \"requestType: 'Custom'\" as CustomRequests\n| parse @message \"Query param edits:\" as QueryParamRequests\n| parse @message \"expires\" as ExpiresRequests\n| stats count(DefaultRequests) as DefaultRequestsCount, count(ThumborRequests) as ThumborRequestsCount, count(CustomRequests) as CustomRequestsCount, count(QueryParamRequests) as QueryParamRequestsCount, count(ExpiresRequests) as ExpiresRequestsCount"}}}}}}}}},"OperationalInsightsDashboard":{"id":"OperationalInsightsDashboard","path":"ServerlessImageHandlerStack/OperationalInsightsDashboard","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"OperationalInsightsDashboard":{"id":"OperationalInsightsDashboard","path":"ServerlessImageHandlerStack/OperationalInsightsDashboard/OperationalInsightsDashboard","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Dashboard","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/OperationalInsightsDashboard/OperationalInsightsDashboard/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnDashboard","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Dashboard","aws:cdk:cloudformation:props":{"dashboardBody":{"Fn::Join":["",["{\"start\":\"-P7D\",\"periodOverride\":\"inherit\",\"widgets\":[{\"type\":\"text\",\"width\":24,\"height\":1,\"x\":0,\"y\":0,\"properties\":{\"markdown\":\"# Lambda\"}},{\"type\":\"metric\",\"width\":8,\"height\":8,\"x\":0,\"y\":1,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Lambda Errors\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/Lambda\",\"Errors\",\"FunctionName\",\"",{"Ref":"BackEndImageHandlerLambdaFunctionADEF7FF2"},"\",{\"label\":\"Lambda Errors\",\"stat\":\"Sum\",\"id\":\"metric\"}],[{\"label\":\"Total\",\"expression\":\"RUNNING_SUM(metric)\",\"yAxis\":\"right\"}]],\"yAxis\":{\"left\":{\"label\":\"Count\",\"showUnits\":false,\"min\":0},\"right\":{\"label\":\"Running-Total Count\",\"showUnits\":false,\"min\":0}},\"legend\":{\"position\":\"bottom\"},\"liveData\":true,\"period\":86400,\"stat\":\"Sum\"}},{\"type\":\"metric\",\"width\":8,\"height\":8,\"x\":8,\"y\":1,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Lambda Duration\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/Lambda\",\"Duration\",\"FunctionName\",\"",{"Ref":"BackEndImageHandlerLambdaFunctionADEF7FF2"},"\",{\"label\":\"Lambda Duration\",\"stat\":\"Sum\",\"id\":\"metric\"}],[{\"label\":\"Total\",\"expression\":\"RUNNING_SUM(metric)\",\"yAxis\":\"right\"}]],\"yAxis\":{\"left\":{\"label\":\"Milliseconds\",\"showUnits\":false,\"min\":0},\"right\":{\"label\":\"Running-Total Milliseconds\",\"showUnits\":false,\"min\":0}},\"legend\":{\"position\":\"bottom\"},\"liveData\":true,\"period\":86400,\"stat\":\"Sum\"}},{\"type\":\"metric\",\"width\":8,\"height\":8,\"x\":16,\"y\":1,\"properties\":{\"view\":\"timeSeries\",\"title\":\"Lambda Invocations\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/Lambda\",\"Invocations\",\"FunctionName\",\"",{"Ref":"BackEndImageHandlerLambdaFunctionADEF7FF2"},"\",{\"label\":\"Lambda Invocations\",\"stat\":\"Sum\",\"id\":\"metric\"}],[{\"label\":\"Total\",\"expression\":\"RUNNING_SUM(metric)\",\"yAxis\":\"right\"}]],\"yAxis\":{\"left\":{\"label\":\"Count\",\"showUnits\":false,\"min\":0},\"right\":{\"label\":\"Running-Total Count\",\"showUnits\":false,\"min\":0}},\"legend\":{\"position\":\"bottom\"},\"liveData\":true,\"period\":86400,\"stat\":\"Sum\"}},{\"type\":\"text\",\"width\":24,\"height\":1,\"x\":0,\"y\":9,\"properties\":{\"markdown\":\"# CloudFront\"}},{\"type\":\"metric\",\"width\":12,\"height\":12,\"x\":0,\"y\":10,\"properties\":{\"view\":\"timeSeries\",\"title\":\"CloudFront Requests\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/CloudFront\",\"Requests\",\"DistributionId\",\"",{"Fn::If":["CommonResourcesUseExistingCloudFrontDistributionConditionEBC48184",{"Ref":"ExistingCloudFrontDistributionIdParameter"},{"Fn::If":["CommonResourcesEnableS3ObjectLambdaConditionF2C07DCD",{"Ref":"BackEndImageHandlerCloudFrontDistributionB5464C90"},{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaCloudFrontToApiGatewayCloudFrontDistribution03AA31B2"}]}]},"\",\"Region\",\"Global\",{\"label\":\"CloudFront Requests\",\"region\":\"us-east-1\",\"stat\":\"Sum\",\"id\":\"metric\"}],[{\"label\":\"Total\",\"expression\":\"RUNNING_SUM(metric)\",\"yAxis\":\"right\"}]],\"yAxis\":{\"left\":{\"label\":\"Count\",\"showUnits\":false,\"min\":0},\"right\":{\"label\":\"Running-Total Count\",\"showUnits\":false,\"min\":0}},\"legend\":{\"position\":\"bottom\"},\"liveData\":true,\"period\":86400,\"stat\":\"Sum\"}},{\"type\":\"metric\",\"width\":12,\"height\":12,\"x\":12,\"y\":10,\"properties\":{\"view\":\"timeSeries\",\"title\":\"CloudFront Bytes Downloaded\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[\"AWS/CloudFront\",\"BytesDownloaded\",\"DistributionId\",\"",{"Fn::If":["CommonResourcesUseExistingCloudFrontDistributionConditionEBC48184",{"Ref":"ExistingCloudFrontDistributionIdParameter"},{"Fn::If":["CommonResourcesEnableS3ObjectLambdaConditionF2C07DCD",{"Ref":"BackEndImageHandlerCloudFrontDistributionB5464C90"},{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaCloudFrontToApiGatewayCloudFrontDistribution03AA31B2"}]}]},"\",\"Region\",\"Global\",{\"label\":\"CloudFront Bytes Downloaded\",\"region\":\"us-east-1\",\"stat\":\"Sum\",\"id\":\"metric\"}],[{\"label\":\"Total\",\"expression\":\"RUNNING_SUM(metric)\",\"yAxis\":\"right\"}]],\"yAxis\":{\"left\":{\"label\":\"Bytes\",\"showUnits\":false,\"min\":0},\"right\":{\"label\":\"Running-Total Bytes\",\"showUnits\":false,\"min\":0}},\"legend\":{\"position\":\"bottom\"},\"liveData\":true,\"period\":86400,\"stat\":\"Sum\"}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":0,\"y\":22,\"properties\":{\"view\":\"singleValue\",\"title\":\"Cache Hit Rate\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[{\"label\":\"Cache Hit Rate (%)\",\"expression\":\"100 * (cloudFrontRequests - lambdaInvocations) / (cloudFrontRequests)\"}],[\"AWS/CloudFront\",\"Requests\",\"DistributionId\",\"",{"Fn::If":["CommonResourcesUseExistingCloudFrontDistributionConditionEBC48184",{"Ref":"ExistingCloudFrontDistributionIdParameter"},{"Fn::If":["CommonResourcesEnableS3ObjectLambdaConditionF2C07DCD",{"Ref":"BackEndImageHandlerCloudFrontDistributionB5464C90"},{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaCloudFrontToApiGatewayCloudFrontDistribution03AA31B2"}]}]},"\",\"Region\",\"Global\",{\"region\":\"us-east-1\",\"stat\":\"Sum\",\"visible\":false,\"id\":\"cloudFrontRequests\"}],[\"AWS/Lambda\",\"Invocations\",\"FunctionName\",\"",{"Ref":"BackEndImageHandlerLambdaFunctionADEF7FF2"},"\",{\"stat\":\"Sum\",\"visible\":false,\"id\":\"lambdaInvocations\"}]],\"setPeriodToTimeRange\":true}},{\"type\":\"metric\",\"width\":12,\"height\":6,\"x\":12,\"y\":22,\"properties\":{\"view\":\"singleValue\",\"title\":\"Average Image Size\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[{\"label\":\"Average Image Size (Bytes)\",\"expression\":\"cloudFrontBytesDownloaded / cloudFrontRequests\"}],[\"AWS/CloudFront\",\"BytesDownloaded\",\"DistributionId\",\"",{"Fn::If":["CommonResourcesUseExistingCloudFrontDistributionConditionEBC48184",{"Ref":"ExistingCloudFrontDistributionIdParameter"},{"Fn::If":["CommonResourcesEnableS3ObjectLambdaConditionF2C07DCD",{"Ref":"BackEndImageHandlerCloudFrontDistributionB5464C90"},{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaCloudFrontToApiGatewayCloudFrontDistribution03AA31B2"}]}]},"\",\"Region\",\"Global\",{\"region\":\"us-east-1\",\"stat\":\"Sum\",\"visible\":false,\"id\":\"cloudFrontBytesDownloaded\"}],[\"AWS/CloudFront\",\"Requests\",\"DistributionId\",\"",{"Fn::If":["CommonResourcesUseExistingCloudFrontDistributionConditionEBC48184",{"Ref":"ExistingCloudFrontDistributionIdParameter"},{"Fn::If":["CommonResourcesEnableS3ObjectLambdaConditionF2C07DCD",{"Ref":"BackEndImageHandlerCloudFrontDistributionB5464C90"},{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaCloudFrontToApiGatewayCloudFrontDistribution03AA31B2"}]}]},"\",\"Region\",\"Global\",{\"region\":\"us-east-1\",\"stat\":\"Sum\",\"visible\":false,\"id\":\"cloudFrontRequests\"}]],\"setPeriodToTimeRange\":true}},{\"type\":\"text\",\"width\":24,\"height\":1,\"x\":0,\"y\":28,\"properties\":{\"markdown\":\"# Overall\"}},{\"type\":\"metric\",\"width\":24,\"height\":6,\"x\":0,\"y\":29,\"properties\":{\"view\":\"singleValue\",\"title\":\"Estimated Cost\",\"region\":\"",{"Ref":"AWS::Region"},"\",\"metrics\":[[{\"label\":\"Estimated Cost($)\",\"expression\":\"7.916241884231568e-11 * cloudFrontBytesDownloaded + 7.5e-7 * cloudFrontRequests + 1.66667e-8 * lambdaDuration + 2.0000000000000002e-7 * lambdaInvocations\"}],[\"AWS/CloudFront\",\"BytesDownloaded\",\"DistributionId\",\"",{"Fn::If":["CommonResourcesUseExistingCloudFrontDistributionConditionEBC48184",{"Ref":"ExistingCloudFrontDistributionIdParameter"},{"Fn::If":["CommonResourcesEnableS3ObjectLambdaConditionF2C07DCD",{"Ref":"BackEndImageHandlerCloudFrontDistributionB5464C90"},{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaCloudFrontToApiGatewayCloudFrontDistribution03AA31B2"}]}]},"\",\"Region\",\"Global\",{\"region\":\"us-east-1\",\"stat\":\"Sum\",\"visible\":false,\"id\":\"cloudFrontBytesDownloaded\"}],[\"AWS/CloudFront\",\"Requests\",\"DistributionId\",\"",{"Fn::If":["CommonResourcesUseExistingCloudFrontDistributionConditionEBC48184",{"Ref":"ExistingCloudFrontDistributionIdParameter"},{"Fn::If":["CommonResourcesEnableS3ObjectLambdaConditionF2C07DCD",{"Ref":"BackEndImageHandlerCloudFrontDistributionB5464C90"},{"Ref":"BackEndImageHandlerCloudFrontApiGatewayLambdaCloudFrontToApiGatewayCloudFrontDistribution03AA31B2"}]}]},"\",\"Region\",\"Global\",{\"region\":\"us-east-1\",\"stat\":\"Sum\",\"visible\":false,\"id\":\"cloudFrontRequests\"}],[\"AWS/Lambda\",\"Duration\",\"FunctionName\",\"",{"Ref":"BackEndImageHandlerLambdaFunctionADEF7FF2"},"\",{\"stat\":\"Sum\",\"visible\":false,\"id\":\"lambdaDuration\"}],[\"AWS/Lambda\",\"Invocations\",\"FunctionName\",\"",{"Ref":"BackEndImageHandlerLambdaFunctionADEF7FF2"},"\",{\"stat\":\"Sum\",\"visible\":false,\"id\":\"lambdaInvocations\"}]],\"setPeriodToTimeRange\":true,\"singleValueFullPrecision\":true}}]}"]]},"dashboardName":{"Fn::Join":["",[{"Ref":"AWS::StackName"},"-",{"Ref":"AWS::Region"},"-Operational-Insights-Dashboard"]]}}}}}}}},"Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C":{"id":"Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C","path":"ServerlessImageHandlerStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.202.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ServerlessImageHandlerStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.202.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ServerlessImageHandlerStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.202.0","metadata":[]}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}],"tags":[{"key":"SolutionId","value":"SO0023"}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ServerlessImageHandlerStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::",{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"}]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::",{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"/*"]]}]},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["FrontEndDistributionToS3S3Bucket3A171D78","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FrontEndDistributionToS3S3Bucket3A171D78","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF","roles":[{"Ref":"CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265"}]}}}}}}},"Code":{"id":"Code","path":"ServerlessImageHandlerStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.202.0"},"children":{"Stage":{"id":"Stage","path":"ServerlessImageHandlerStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.202.0"}},"AssetBucket":{"id":"AssetBucket","path":"ServerlessImageHandlerStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.202.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ServerlessImageHandlerStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"9a1fcb4a7ecba81ad70e9d3fb241f6794497da945dae5f25924e4dd002b65f2d.zip"},"environment":{"variables":{"AWS_CA_BUNDLE":"/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem"}},"handler":"index.handler","layers":[{"Ref":"CommonResourcesCustomResourcesDeployWebsiteAwsCliLayerBC025F39"}],"role":{"Fn::GetAtt":["CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265","Arn"]},"runtime":"python3.11","tags":[{"key":"SolutionId","value":"SO0023"}],"timeout":900}}}}},"ApiEndpoint":{"id":"ApiEndpoint","path":"ServerlessImageHandlerStack/ApiEndpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.202.0"}},"DemoUrl":{"id":"DemoUrl","path":"ServerlessImageHandlerStack/DemoUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.202.0"}},"SourceBuckets":{"id":"SourceBuckets","path":"ServerlessImageHandlerStack/SourceBuckets","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.202.0"}},"CorsEnabled":{"id":"CorsEnabled","path":"ServerlessImageHandlerStack/CorsEnabled","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.202.0"}},"CorsOrigin":{"id":"CorsOrigin","path":"ServerlessImageHandlerStack/CorsOrigin","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.202.0"}},"LogRetentionPeriod":{"id":"LogRetentionPeriod","path":"ServerlessImageHandlerStack/LogRetentionPeriod","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.202.0"}},"CloudFrontLoggingBucket":{"id":"CloudFrontLoggingBucket","path":"ServerlessImageHandlerStack/CloudFrontLoggingBucket","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.202.0"}},"CloudFrontDashboard":{"id":"CloudFrontDashboard","path":"ServerlessImageHandlerStack/CloudFrontDashboard","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.202.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"ServerlessImageHandlerStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"ServerlessImageHandlerStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}},"Condition":{"id":"Condition","path":"ServerlessImageHandlerStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}}}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}