# AWS CDK êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

## ì§„í–‰ ìƒí™©
- ì‹œì‘ì¼: 2025-10-31
- í˜„ì¬ ë‹¨ê³„: Phase 7 - Main Stack êµ¬í˜„ ì™„ë£Œ
- ì „ì²´ ì§„í–‰ë¥ : 85%
- ìµœì¢… ì—…ë°ì´íŠ¸: 2025-10-31

---

## Phase 1: í”„ë¡œì íŠ¸ ê¸°ë³¸ ì„¤ì • (5%)

### 1.1 í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„±
- [x] ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
  - [x] `lib/config/` - í™˜ê²½ ì„¤ì •
  - [x] `lib/interfaces/` - íƒ€ì… ì •ì˜
  - [x] `lib/constructs/storage/` - Storage Constructs
  - [x] `lib/constructs/compute/` - Lambda Constructs
  - [x] `lib/constructs/messaging/` - SQS Constructs
  - [x] `lib/constructs/api/` - API Gateway Constructs
  - [x] `lib/constructs/monitoring/` - ëª¨ë‹ˆí„°ë§ Constructs
  - [x] `lib/stacks/` - CDK Stacks
  - [x] `lambda/shared/` - ê³µìœ  Lambda ì½”ë“œ
  - [x] `lambda/detect-text/` - Detect Text Lambda
  - [x] `lambda/index-faces/` - Index Faces Lambda
  - [x] `lambda/find-by-selfie/` - Find By Selfie Lambda
  - [x] `test/unit/` - ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
  - [x] `test/integration/` - í†µí•© í…ŒìŠ¤íŠ¸

### 1.2 Config ë° Interface íŒŒì¼
- [x] `lib/config/environment.ts` - í™˜ê²½ë³„ ì„¤ì • âœ…
- [x] `lib/config/constants.ts` - ìƒìˆ˜ ì •ì˜ âœ…
- [x] `lib/interfaces/photo.interface.ts` - Photo íƒ€ì… âœ…
- [x] `lib/interfaces/runner.interface.ts` - Runner íƒ€ì… âœ…
- [x] `lib/interfaces/event.interface.ts` - Event íƒ€ì… âœ…

### 1.3 Package.json ë° CDK ì„¤ì •
- [x] `package.json` ì—…ë°ì´íŠ¸ âœ…
  - [x] ì˜ì¡´ì„± ì¶”ê°€ âœ…
  - [x] ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€ âœ…
- [x] `cdk.json` ì—…ë°ì´íŠ¸ âœ…
- [ ] `tsconfig.json` ì„¤ì •
- [ ] `.gitignore` ì—…ë°ì´íŠ¸

---

## Phase 2: Storage Layer êµ¬í˜„ (25%) âœ… ì™„ë£Œ

### 2.1 DynamoDB Tables Construct
- [x] `lib/constructs/storage/tables.construct.ts` âœ…
  - [x] PhotosTable ìƒì„± âœ…
    - [x] PK/SK ì„¤ì • âœ…
    - [x] GSI1 ì¶”ê°€ (Bibë³„ ì¡°íšŒ) âœ…
    - [x] ìŠ¤íŠ¸ë¦¼ í™œì„±í™” âœ…
  - [x] PhotoFacesTable ìƒì„± âœ…
    - [x] PK/SK ì„¤ì • âœ…
  - [x] RunnersTable ìƒì„± âœ…
    - [x] PK/SK ì„¤ì • âœ…
  - [x] EventsTable ìƒì„± âœ…
    - [x] PK/SK ì„¤ì • âœ…
  - [x] í™˜ê²½ë³„ ì„¤ì • ì ìš© âœ…
    - [x] ì˜¨ë””ë§¨ë“œ ë¹Œë§ ëª¨ë“œ âœ…
    - [x] RemovalPolicy ì„¤ì • âœ…
    - [x] PITR ì„¤ì • (prodë§Œ) âœ…

### 2.2 S3 Bucket Construct
- [x] `lib/constructs/storage/photos-bucket.construct.ts` âœ…
  - [x] ë²„í‚· ìƒì„± âœ…
  - [x] ë³´ì•ˆ ì„¤ì • âœ…
    - [x] BlockPublicAccess âœ…
    - [x] Encryption âœ…
    - [x] EnforceSSL âœ…
  - [x] ë²„ì „ ê´€ë¦¬ (prodë§Œ) âœ…
  - [x] ìˆ˜ëª… ì£¼ê¸° ì •ì±… âœ…
  - [x] CORS ì„¤ì • âœ…
  - [x] EventBridge í™œì„±í™” âœ…

---

## Phase 3: Messaging Layer êµ¬í˜„ (35%) âœ… ì™„ë£Œ

### 3.1 SQS Queue Construct
- [x] `lib/constructs/messaging/photo-queue.construct.ts` âœ…
  - [x] DLQ ìƒì„± âœ…
    - [x] ë³´ì¡´ ê¸°ê°„ ì„¤ì • âœ…
    - [x] ì•”í˜¸í™” ì„¤ì • âœ…
  - [x] Main Queue ìƒì„± âœ…
    - [x] Visibility timeout ì„¤ì • âœ…
    - [x] Long polling ì„¤ì • âœ…
    - [x] DLQ ì—°ê²° âœ…
    - [x] ì•”í˜¸í™” ì„¤ì • âœ…

---

## Phase 4: Compute Layer êµ¬í˜„ (60%) âœ… ì™„ë£Œ

### 4.1 Base Lambda Construct
- [x] `lib/constructs/compute/base-function.construct.ts` âœ…
  - [x] ê¸°ë³¸ Lambda í•¨ìˆ˜ ìƒì„± âœ…
  - [x] Runtime ì„¤ì • (Node.js 20.x) âœ…
  - [x] íƒ€ì„ì•„ì›ƒ ì„¤ì • âœ…
  - [x] ë©”ëª¨ë¦¬ ì„¤ì • âœ…
  - [x] í™˜ê²½ ë³€ìˆ˜ ì£¼ì… âœ…
  - [x] ë¡œê·¸ ë³´ì¡´ ê¸°ê°„ ì„¤ì • âœ…
  - [x] X-Ray ì¶”ì  í™œì„±í™” âœ…
  - [x] ë™ì‹œ ì‹¤í–‰ ì œí•œ âœ…
  - [x] Powertools Layer ì¶”ê°€ (ì„ íƒ) âœ…

### 4.2 Detect Text Lambda Construct
- [x] `lib/constructs/compute/detect-text.construct.ts` âœ…
  - [x] BaseFunctionConstruct ìƒì† âœ…
  - [x] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • âœ…
  - [x] S3 ì½ê¸° ê¶Œí•œ ë¶€ì—¬ âœ…
  - [x] DynamoDB ì“°ê¸° ê¶Œí•œ ë¶€ì—¬ âœ…
  - [x] SQS ì „ì†¡ ê¶Œí•œ ë¶€ì—¬ âœ…
  - [x] Rekognition DetectText ê¶Œí•œ ë¶€ì—¬ âœ…

### 4.3 Index Faces Lambda Construct
- [x] `lib/constructs/compute/index-faces.construct.ts` âœ…
  - [x] BaseFunctionConstruct ìƒì† âœ…
  - [x] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • âœ…
  - [x] SQS ì´ë²¤íŠ¸ ì†ŒìŠ¤ ì—°ê²° âœ…
    - [x] ë°°ì¹˜ í¬ê¸° ì„¤ì • âœ…
    - [x] ë°°ì¹˜ ìœˆë„ìš° ì„¤ì • âœ…
    - [x] ë°°ì¹˜ ì‹¤íŒ¨ ë¦¬í¬íŒ… í™œì„±í™” âœ…
  - [x] DynamoDB ì½ê¸°/ì“°ê¸° ê¶Œí•œ ë¶€ì—¬ âœ…
  - [x] Rekognition ê¶Œí•œ ë¶€ì—¬ âœ…
    - [x] IndexFaces âœ…
    - [x] SearchFaces âœ…
    - [x] CreateCollection âœ…
    - [x] DescribeCollection âœ…

### 4.4 Find By Selfie Lambda Construct
- [x] `lib/constructs/compute/find-by-selfie.construct.ts` âœ…
  - [x] BaseFunctionConstruct ìƒì† âœ…
  - [x] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • âœ…
  - [x] DynamoDB ì½ê¸° ê¶Œí•œ ë¶€ì—¬ âœ…
  - [x] Rekognition SearchFacesByImage ê¶Œí•œ ë¶€ì—¬ âœ…

---

## Phase 5: API Layer êµ¬í˜„ (70%) âœ… ì™„ë£Œ

### 5.1 REST API Construct
- [x] `lib/constructs/api/rest-api.construct.ts` âœ…
  - [x] API Gateway ìƒì„± âœ…
  - [x] ë°°í¬ ì˜µì…˜ ì„¤ì • âœ…
    - [x] ìŠ¤í…Œì´ì§€ ì„¤ì • âœ…
    - [x] ìŠ¤ë¡œí‹€ë§ ì„¤ì • âœ…
    - [x] ë¡œê¹… ë ˆë²¨ ì„¤ì • âœ…
  - [x] CORS ì„¤ì • âœ…
  - [x] `/selfie` ì—”ë“œí¬ì¸íŠ¸ ìƒì„± âœ…
    - [x] POST ë©”ì„œë“œ ì¶”ê°€ âœ…
    - [x] Lambda í†µí•© âœ…
  - [x] API í‚¤ ì„¤ì • (prodë§Œ) âœ…
  - [x] Usage Plan ì„¤ì • (prodë§Œ) âœ…

---

## Phase 6: Monitoring Layer êµ¬í˜„ (80%) âœ… ì™„ë£Œ

### 6.1 Alarms Construct
- [x] `lib/constructs/monitoring/alarms.construct.ts` âœ…
  - [x] SNS Topic ìƒì„± âœ…
  - [x] Lambda ì—ëŸ¬ ì•ŒëŒ âœ…
  - [x] Lambda íƒ€ì„ì•„ì›ƒ ì•ŒëŒ âœ…
  - [x] DLQ ë©”ì‹œì§€ ì•ŒëŒ âœ…
  - [ ] API Gateway ì—ëŸ¬ ì•ŒëŒ (ì¶”í›„ ì¶”ê°€ ê°€ëŠ¥)

---

## Phase 7: Main Stack êµ¬í˜„ (85%) âœ… ì™„ë£Œ

### 7.1 SnapRace Stack
- [x] `lib/stacks/snaprace-stack.ts` âœ…
  - [x] Storage Layer ì¡°í•© âœ…
    - [x] Tables Construct ìƒì„± âœ…
    - [x] PhotosBucket Construct ìƒì„± âœ…
  - [x] Messaging Layer ì¡°í•© âœ…
    - [x] PhotoQueue Construct ìƒì„± âœ…
  - [x] Compute Layer ì¡°í•© âœ…
    - [x] DetectText Construct ìƒì„± âœ…
    - [x] IndexFaces Construct ìƒì„± âœ…
    - [x] FindBySelfie Construct ìƒì„± âœ…
  - [x] API Layer ì¡°í•© âœ…
    - [x] RestApi Construct ìƒì„± âœ…
  - [x] Monitoring Layer ì¡°í•© âœ…
    - [x] Alarms Construct ìƒì„± âœ…
  - [x] EventBridge ê·œì¹™ ì„¤ì • âœ…
    - [x] S3 Upload â†’ Lambda ì—°ê²° âœ…
  - [x] CloudFormation Outputs âœ…
    - [x] API Endpoint âœ…
    - [x] Bucket Name âœ…
    - [x] Queue URL âœ…

### 7.2 CDK App ì§„ì…ì 
- [x] `bin/infra.ts` âœ…
  - [x] CDK App ìƒì„± âœ…
  - [x] Stage ì»¨í…ìŠ¤íŠ¸ ì½ê¸° âœ…
  - [x] SnapRaceStack ì¸ìŠ¤í„´ìŠ¤í™” âœ…
  - [x] í™˜ê²½ ì„¤ì • âœ…
  - [x] íƒœê·¸ ì¶”ê°€ âœ…

---

## Phase 8: Lambda í•¨ìˆ˜ êµ¬í˜„ (95%) ğŸš§ ì§„í–‰ ì¤‘

### 8.1 ê³µìœ  ì„œë¹„ìŠ¤ ë ˆì´ì–´
- [ ] `lambda/shared/services/dynamodb.service.ts` ğŸš§ ë‹¤ìŒ ë‹¨ê³„
  - [ ] DynamoDB Client ì´ˆê¸°í™”
  - [ ] Photos í…Œì´ë¸” ì‘ì—…
  - [ ] PhotoFaces í…Œì´ë¸” ì‘ì—…
  - [ ] Runners í…Œì´ë¸” ì‘ì—…
  - [ ] Events í…Œì´ë¸” ì‘ì—…
- [ ] `lambda/shared/services/rekognition.service.ts` ğŸš§ ë‹¤ìŒ ë‹¨ê³„
  - [ ] Rekognition Client ì´ˆê¸°í™”
  - [ ] DetectText ë©”ì„œë“œ
  - [ ] IndexFaces ë©”ì„œë“œ
  - [ ] SearchFaces ë©”ì„œë“œ
  - [ ] SearchFacesByImage ë©”ì„œë“œ
- [ ] `lambda/shared/services/sqs.service.ts` ğŸš§ ë‹¤ìŒ ë‹¨ê³„
  - [ ] SQS Client ì´ˆê¸°í™”
  - [ ] SendMessage ë©”ì„œë“œ
- [ ] `lambda/shared/services/s3.service.ts` ğŸš§ ë‹¤ìŒ ë‹¨ê³„
  - [ ] S3 Client ì´ˆê¸°í™”
  - [ ] GetObject ë©”ì„œë“œ
- [ ] `lambda/shared/utils/logger.ts` ğŸš§ ë‹¤ìŒ ë‹¨ê³„
  - [ ] Powertools Logger ì„¤ì •
- [ ] `lambda/shared/utils/validators.ts` ğŸš§ ë‹¤ìŒ ë‹¨ê³„
  - [ ] S3 í‚¤ ê²€ì¦
  - [ ] ì…ë ¥ ë°ì´í„° ê²€ì¦

### 8.2 Detect Text Lambda
- [x] `lambda/detect-text/index.ts` âœ… (ê¸°ë³¸ êµ¬ì¡°)
  - [x] Handler ìŠ¤ì¼ˆë ˆí†¤ âœ…
  - [ ] S3 ì´ë²¤íŠ¸ íŒŒì‹± ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] Rekognition DetectText í˜¸ì¶œ ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] ì›Œí„°ë§ˆí¬ í•„í„°ë§ ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] ìœ íš¨í•œ Bib ë§¤ì¹­ ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] DynamoDB ì €ì¥ ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] SQS ë©”ì‹œì§€ ì „ì†¡ ğŸš§ êµ¬í˜„ í•„ìš”
- [x] `lambda/detect-text/package.json` âœ…
  - [x] ì˜ì¡´ì„± ì„¤ì • âœ…

### 8.3 Index Faces Lambda
- [x] `lambda/index-faces/index.ts` âœ… (ê¸°ë³¸ êµ¬ì¡°)
  - [x] Handler ìŠ¤ì¼ˆë ˆí†¤ âœ…
  - [ ] SQS ë©”ì‹œì§€ íŒŒì‹± ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] Rekognition Collection í™•ì¸/ìƒì„± ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] Rekognition IndexFaces í˜¸ì¶œ ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] Rekognition SearchFaces í˜¸ì¶œ ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] Bib ê²°ì • ë¡œì§ ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] Photos í…Œì´ë¸” ì—…ë°ì´íŠ¸ ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] PhotoFaces í…Œì´ë¸” ì €ì¥ ğŸš§ êµ¬í˜„ í•„ìš”
- [x] `lambda/index-faces/package.json` âœ…
  - [x] ì˜ì¡´ì„± ì„¤ì • âœ…

### 8.4 Find By Selfie Lambda
- [x] `lambda/find-by-selfie/index.ts` âœ… (ê¸°ë³¸ êµ¬ì¡°)
  - [x] Handler ìŠ¤ì¼ˆë ˆí†¤ âœ…
  - [ ] API Gateway ì´ë²¤íŠ¸ íŒŒì‹± ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] Base64 ì´ë¯¸ì§€ ë””ì½”ë”© ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] Rekognition SearchFacesByImage í˜¸ì¶œ ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] PhotoFaces í…Œì´ë¸” ì¿¼ë¦¬ ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] ì¤‘ë³µ ì œê±° ğŸš§ êµ¬í˜„ í•„ìš”
  - [ ] ì‘ë‹µ ë°˜í™˜ ğŸš§ êµ¬í˜„ í•„ìš”
- [x] `lambda/find-by-selfie/package.json` âœ…
  - [x] ì˜ì¡´ì„± ì„¤ì • âœ…

---

## Phase 9: í…ŒìŠ¤íŠ¸ ë° ë°°í¬ (100%)

### 9.1 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- [ ] `test/unit/constructs/storage.test.ts`
- [ ] `test/unit/constructs/compute.test.ts`
- [ ] `test/unit/constructs/messaging.test.ts`
- [ ] `test/unit/constructs/api.test.ts`

### 9.2 í†µí•© í…ŒìŠ¤íŠ¸
- [ ] `test/integration/stack.test.ts`
  - [ ] ìŠ¤íƒ ìƒì„± í…ŒìŠ¤íŠ¸
  - [ ] ë¦¬ì†ŒìŠ¤ ì¡´ì¬ í™•ì¸

### 9.3 CDK ëª…ë ¹ í…ŒìŠ¤íŠ¸
- [ ] `cdk synth` ì‹¤í–‰
- [ ] `cdk diff` ì‹¤í–‰
- [ ] CloudFormation í…œí”Œë¦¿ ê²€ì¦

### 9.4 Dev í™˜ê²½ ë°°í¬
- [ ] `cdk bootstrap` ì‹¤í–‰ (ìµœì´ˆ 1íšŒ)
- [ ] `cdk deploy -c stage=dev` ì‹¤í–‰
- [ ] ë¦¬ì†ŒìŠ¤ ìƒì„± í™•ì¸
- [ ] Lambda í•¨ìˆ˜ í…ŒìŠ¤íŠ¸
- [ ] API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸

### 9.5 CI/CD íŒŒì´í”„ë¼ì¸
- [ ] GitHub Actions ì›Œí¬í”Œë¡œìš° ìƒì„±
- [ ] AWS ìê²© ì¦ëª… ì„¤ì •
- [ ] Dev ìë™ ë°°í¬ ì„¤ì •
- [ ] Prod ë°°í¬ ìŠ¹ì¸ í”„ë¡œì„¸ìŠ¤

---

## ì™„ë£Œ ê¸°ì¤€

### í•„ìˆ˜ (Must Have)
- [ ] ëª¨ë“  Constructê°€ ì •ìƒì ìœ¼ë¡œ ìƒì„±ë¨
- [ ] Lambda í•¨ìˆ˜ê°€ ì •ìƒì ìœ¼ë¡œ ë°°í¬ë¨
- [ ] S3 ì—…ë¡œë“œ ì‹œ ì „ì²´ í”Œë¡œìš°ê°€ ë™ì‘í•¨
- [ ] APIë¥¼ í†µí•œ ì‚¬ì§„ ê²€ìƒ‰ì´ ë™ì‘í•¨
- [ ] ê¸°ë³¸ ëª¨ë‹ˆí„°ë§ ë° ì•ŒëŒì´ ì„¤ì •ë¨

### ê¶Œì¥ (Should Have)
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 70% ì´ìƒ
- [ ] í†µí•© í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•
- [ ] ë¬¸ì„œí™” ì™„ë£Œ

### ì„ íƒ (Nice to Have)
- [ ] CloudWatch Dashboard êµ¬ì„±
- [ ] Cost Explorer ì„¤ì •
- [ ] ì„±ëŠ¥ ìµœì í™”
- [ ] ë¶€í•˜ í…ŒìŠ¤íŠ¸

---

## ì°¸ê³  ì‚¬í•­

### ê°œë°œ í™˜ê²½ ìš”êµ¬ì‚¬í•­
- Node.js 20.x
- AWS CDK CLI 2.150.0+
- pnpm 8.x
- AWS CLI êµ¬ì„± ì™„ë£Œ
- AWS ê³„ì • ë° ê¶Œí•œ ì„¤ì •

### ì¤‘ìš” ë§í¬
- [AWS CDK ì•„í‚¤í…ì²˜ ë¬¸ì„œ](/docs/spec/aws-cdk-architecture.md)
- [Lambda ë¦¬íŒ©í† ë§ ë¶„ì„ ë¬¸ì„œ](/docs/spec/lambda-refactoring-analysis.md)
- [AWS CDK ê³µì‹ ë¬¸ì„œ](https://docs.aws.amazon.com/cdk/v2/guide/home.html)
- [AWS Solutions Constructs](https://docs.aws.amazon.com/solutions/latest/constructs/welcome.html)

### íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
- CDK ë¶€íŠ¸ìŠ¤íŠ¸ë© ë¬¸ì œ: [í•´ê²° ë°©ë²•]
- Lambda ê¶Œí•œ ë¬¸ì œ: [í•´ê²° ë°©ë²•]
- DynamoDB ìŠ¤í‚¤ë§ˆ ë¬¸ì œ: [í•´ê²° ë°©ë²•]

